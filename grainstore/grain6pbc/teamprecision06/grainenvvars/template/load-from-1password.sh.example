#!/bin/bash
# ============================================================================
# GRAINENVVARS - 1PASSWORD LOADER (TEMPLATE)
# ============================================================================
# Copy to personal/load-from-1password.sh and customize
# Store your actual secrets in 1Password vault
# ============================================================================

# Check if 1Password CLI is installed
if ! command -v op &> /dev/null; then
    echo "‚ö†Ô∏è  1Password CLI not installed. Install from: https://1password.com/downloads/command-line/"
    return 1
fi

# Check if signed in
if ! op account list &> /dev/null; then
    echo "üîê Signing into 1Password..."
    eval $(op signin)
fi

# ----------------------------------------------------------------------------
# AI & LLM APIs
# ----------------------------------------------------------------------------

# OpenAI
export OPENAI_API_KEY=$(op item get "OpenAI API Key" --fields password 2>/dev/null || echo "NOT_SET")

# Anthropic (Claude)
export ANTHROPIC_API_KEY=$(op item get "Anthropic API Key" --fields password 2>/dev/null || echo "NOT_SET")

# ----------------------------------------------------------------------------
# Blockchain & Crypto
# ----------------------------------------------------------------------------

# ICP Principal
export ICP_PRINCIPAL=$(op item get "ICP Principal" --fields password 2>/dev/null || echo "NOT_SET")

# Solana (wallet address only - NEVER private keys in env!)
export SOLANA_WALLET_ADDRESS=$(op item get "Solana Wallet Address" --fields password 2>/dev/null || echo "NOT_SET")

# ----------------------------------------------------------------------------
# Git & Version Control
# ----------------------------------------------------------------------------

# GitHub Token
export GITHUB_TOKEN=$(op item get "GitHub Personal Access Token" --fields password 2>/dev/null || echo "NOT_SET")

# Codeberg Token
export CODEBERG_TOKEN=$(op item get "Codeberg API Token" --fields password 2>/dev/null || echo "NOT_SET")

# ----------------------------------------------------------------------------
# Google Services
# ----------------------------------------------------------------------------

# Google OAuth
export GOOGLE_CLIENT_ID=$(op item get "Google OAuth Client ID" --fields username 2>/dev/null || echo "NOT_SET")
export GOOGLE_CLIENT_SECRET=$(op item get "Google OAuth Client ID" --fields password 2>/dev/null || echo "NOT_SET")
export GOOGLE_REFRESH_TOKEN=$(op item get "Google Refresh Token" --fields password 2>/dev/null || echo "NOT_SET")

# ----------------------------------------------------------------------------
# Verification
# ----------------------------------------------------------------------------

# Count loaded variables
loaded=0
[ "$OPENAI_API_KEY" != "NOT_SET" ] && ((loaded++))
[ "$ANTHROPIC_API_KEY" != "NOT_SET" ] && ((loaded++))
[ "$GITHUB_TOKEN" != "NOT_SET" ] && ((loaded++))

if [ $loaded -gt 0 ]; then
    echo "‚úÖ Loaded $loaded environment variables from 1Password"
else
    echo "‚ö†Ô∏è  No environment variables loaded from 1Password"
    echo "   Make sure you've stored secrets in your vault"
fi

# ============================================================================
# USAGE:
#   source grainstore/grainenvvars/personal/load-from-1password.sh
# ============================================================================

