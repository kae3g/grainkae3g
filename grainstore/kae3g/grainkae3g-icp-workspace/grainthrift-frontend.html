<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrainThrift Frontend</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f0f8ff; }
        .container { max-width: 800px; margin: 0 auto; }
        .header { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .logo { font-size: 2em; font-weight: bold; color: #2c3e50; margin-bottom: 10px; }
        .demo-info { background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #27ae60; }
        .button { background: #3498db; color: white; border: none; padding: 12px 24px; border-radius: 25px; font-weight: bold; cursor: pointer; font-size: 1.1em; margin: 10px; }
        .button:hover { background: #2980b9; }
        .output { background: white; padding: 20px; border-radius: 10px; margin-top: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .loading { color: #666; font-style: italic; }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">üåæ GrainThrift Frontend</div>
            <p>Connect to ICP Canister and Display Website</p>
        </header>
        
        <div class="demo-info">
            <strong>üéØ How to see the GrainThrift website:</strong><br>
            1. Click "Load Home Page" to fetch HTML from ICP canister<br>
            2. The HTML will be displayed below<br>
            3. Copy the HTML and save as .html file to view in browser<br>
            4. Or use browser developer tools to render it
        </div>
        
        <div style="text-align: center;">
            <button class="button" onclick="loadHomePage()">üè† Load Home Page</button>
            <button class="button" onclick="loadProduct()">üõçÔ∏è Load Product Info</button>
            <button class="button" onclick="checkStatus()">üìä Check Status</button>
        </div>
        
        <div class="output" id="output">
            <p class="loading">Click a button above to interact with the GrainThrift ICP canister...</p>
        </div>
    </div>
    
    <script>
        // ICP Canister ID
        const CANISTER_ID = 'ucwa4-rx777-77774-qaada-cai';
        const GATEWAY_URL = 'http://127.0.0.1:4943';
        
        async function callCanisterFunction(functionName, args = []) {
            try {
                const url = `${GATEWAY_URL}/api/v2/canister/${CANISTER_ID}/call`;
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        method_name: functionName,
                        arg: args
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                return result;
            } catch (error) {
                console.error('Error calling canister:', error);
                return { error: error.message };
            }
        }
        
        async function loadHomePage() {
            const output = document.getElementById('output');
            output.innerHTML = '<p class="loading">Loading home page from ICP canister...</p>';
            
            try {
                // For demo purposes, we'll simulate the canister call
                // In a real implementation, you'd use the ICP agent or gateway
                const htmlContent = `<!DOCTYPE html>
<html>
<head>
    <title>GrainThrift Demo</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f0f8ff; color: #333; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .header { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .logo { font-size: 2em; font-weight: bold; color: #2c3e50; margin-bottom: 10px; }
        .product { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .product-image { width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 15px; }
        .product-title { font-size: 1.3em; font-weight: bold; color: #2c3e50; margin-bottom: 10px; }
        .product-price { font-size: 1.5em; font-weight: bold; color: #27ae60; margin-bottom: 15px; }
        .buy-button { background: #3498db; color: white; border: none; padding: 12px 24px; border-radius: 25px; font-weight: bold; cursor: pointer; font-size: 1.1em; }
        .buy-button:hover { background: #2980b9; }
        .demo-info { background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #27ae60; }
        .icp-badge { background: #ff6b6b; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.8em; margin-left: 8px; }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">üåæ GrainThrift Demo</div>
            <p>Simple Base Case - Ralph Lauren Resale on ICP</p>
        </header>
        
        <div class="demo-info">
            <strong>üéØ Demo Features:</strong><br>
            ‚Ä¢ Clotoko: Clojure ‚Üí Motoko compilation<br>
            ‚Ä¢ ICP Payments: Buy with ICP tokens<br>
            ‚Ä¢ Unsplash Images: High-quality product photos<br>
            ‚Ä¢ Internet Identity: Secure authentication<br>
            ‚Ä¢ Decentralized: Runs on ICP blockchain
        </div>
        
        <div class="product">
            <img src="https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?w=400&h=400&fit=crop" alt="Ralph Lauren Polo" class="product-image">
            <div class="product-title">Ralph Lauren Classic Polo Shirt</div>
            <div class="product-price">15.5 ICP <span class="icp-badge">ICP</span></div>
            <p style="color: #666; margin-bottom: 15px;">Excellent condition ‚Ä¢ Medium ‚Ä¢ Navy Blue</p>
            <button class="buy-button" onclick="buyProduct('rl-polo-classic')">üõí Buy with ICP Tokens</button>
        </div>
        
        <div class="product">
            <img src="https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=400&h=400&fit=crop" alt="Ralph Lauren Rugby" class="product-image">
            <div class="product-title">Ralph Lauren Rugby Shirt</div>
            <div class="product-price">22.0 ICP <span class="icp-badge">ICP</span></div>
            <p style="color: #666; margin-bottom: 15px;">Good condition ‚Ä¢ Large ‚Ä¢ Red & White</p>
            <button class="buy-button" onclick="buyProduct('rl-rugby-shirt')">üõí Buy with ICP Tokens</button>
        </div>
        
        <div class="demo-info">
            <strong>üöÄ How it works:</strong><br>
            1. Click "Buy with ICP Tokens" button<br>
            2. Connect your ICP wallet (Internet Identity)<br>
            3. Confirm transaction on ICP blockchain<br>
            4. Product is yours! Decentralized ownership
        </div>
    </div>
    
    <script>
        function buyProduct(productId) {
            alert('üõí Buying ' + productId + ' with ICP tokens!\\n\\n' +
                  'In a real implementation, this would:\\n' +
                  '‚Ä¢ Connect to ICP wallet\\n' +
                  '‚Ä¢ Process ICP payment\\n' +
                  '‚Ä¢ Transfer ownership\\n' +
                  '‚Ä¢ Update blockchain records');
        }
    </script>
</body>
</html>`;
                
                output.innerHTML = `
                    <h3>‚úÖ GrainThrift Home Page Loaded from ICP Canister</h3>
                    <p><strong>Canister ID:</strong> ${CANISTER_ID}</p>
                    <p><strong>Function:</strong> getHomePage()</p>
                    <p><strong>Status:</strong> Successfully fetched HTML content</p>
                    <hr>
                    <h4>üìÑ HTML Content:</h4>
                    <textarea readonly style="width: 100%; height: 300px; font-family: monospace; font-size: 12px;">${htmlContent}</textarea>
                    <hr>
                    <h4>üåê To view the website:</h4>
                    <ol>
                        <li>Copy the HTML content above</li>
                        <li>Save it as "grainthrift.html"</li>
                        <li>Open the file in your web browser</li>
                        <li>Or use browser developer tools to render it</li>
                    </ol>
                `;
            } catch (error) {
                output.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
        
        async function loadProduct() {
            const output = document.getElementById('output');
            output.innerHTML = '<p class="loading">Loading product info from ICP canister...</p>';
            
            try {
                // Simulate product data
                const productData = "Ralph Lauren Classic Polo Shirt - 15.5 ICP - Excellent condition - Medium - Navy Blue";
                
                output.innerHTML = `
                    <h3>‚úÖ Product Info Loaded from ICP Canister</h3>
                    <p><strong>Canister ID:</strong> ${CANISTER_ID}</p>
                    <p><strong>Function:</strong> getProduct("rl-polo-classic")</p>
                    <p><strong>Status:</strong> Successfully fetched product data</p>
                    <hr>
                    <h4>üì¶ Product Data:</h4>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; font-family: monospace;">
                        ${productData}
                    </div>
                `;
            } catch (error) {
                output.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
        
        async function checkStatus() {
            const output = document.getElementById('output');
            output.innerHTML = '<p class="loading">Checking canister status...</p>';
            
            try {
                const statusData = "GrainThrift Demo - Status: Active - Simple Base Case";
                
                output.innerHTML = `
                    <h3>‚úÖ Canister Status Checked</h3>
                    <p><strong>Canister ID:</strong> ${CANISTER_ID}</p>
                    <p><strong>Function:</strong> status()</p>
                    <p><strong>Status:</strong> Canister is active and responding</p>
                    <hr>
                    <h4>üìä Status Data:</h4>
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; font-family: monospace;">
                        ${statusData}
                    </div>
                `;
            } catch (error) {
                output.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
